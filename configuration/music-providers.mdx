---
title: Music Providers
description: Configure Spotify and YouTube Music for playback and library access
---

## Overview

MiniFy supports two music streaming providers: Spotify and YouTube Music. You must authenticate with at least one provider to use MiniFy.

## Supported Providers

<Accordion title="Spotify">
  Full-featured integration with Spotify Premium.
  
  **Requirements:**
  - Spotify Premium account
  - Spotify Client ID (optional for official builds)
  - Active Spotify session on any device
  
  **Features:**
  - Full playback control
  - Library access
  - Playlist management
  - Recently played tracks
  - Top artists and tracks
  
  See: `spotify_auth.rs`
</Accordion>

<Accordion title="YouTube Music">
  Integration with YouTube Music Premium.
  
  **Requirements:**
  - YouTube Music Premium account (recommended)
  - Google OAuth credentials (optional for official builds)
  
  **Features:**
  - Playback control
  - Library access
  - Playlist management
  
  See: `youtube_auth.rs`
</Accordion>

## Spotify Setup

### Using Official Builds

If you downloaded MiniFy from the official website, Spotify authentication is pre-configured:

<Steps>
  <Step title="Open Settings">
    Navigate to Settings > Music Provider > Spotify
  </Step>
  
  <Step title="Start OAuth">
    Click "Connect Spotify"
    
    See: `spotify_auth.rs:389`
  </Step>
  
  <Step title="Authorize in Browser">
    Your browser will open to Spotify's authorization page
    
    MiniFy requests these permissions:
    - `user-read-playback-state`: Read currently playing track
    - `user-modify-playback-state`: Control playback
    - `user-read-currently-playing`: Access current track details
    - `playlist-read-private`: Read your playlists
    - `playlist-modify-public`: Modify public playlists
    - `playlist-modify-private`: Modify private playlists
    - `user-top-read`: Access top tracks and artists
    - `user-read-recently-played`: Access listening history
    - `user-library-read`: Access saved tracks
    
    See: `spotify_auth.rs:483`
  </Step>
  
  <Step title="Complete Authorization">
    Click "Agree" on the Spotify authorization page
    
    Your browser will redirect to a success page, and MiniFy will receive the access tokens.
  </Step>
  
  <Step title="Verification">
    MiniFy automatically verifies your credentials by making a test API call
    
    See: `spotify_auth.rs:243`
  </Step>
</Steps>

### Using Custom Client ID

For self-built versions or custom configurations:

<Steps>
  <Step title="Create Spotify App">
    1. Go to https://developer.spotify.com/dashboard
    2. Click "Create app"
    3. Fill in app details:
       - **App name**: MiniFy (or your choice)
       - **App description**: Personal music player
       - **Redirect URI**: `http://127.0.0.1:3000/callback`
    4. Save the app
  </Step>
  
  <Step title="Get Client ID">
    Copy the Client ID from your app's dashboard
  </Step>
  
  <Step title="Configure MiniFy">
    1. Open Settings > Music Provider > Spotify
    2. Click "Custom Client ID"
    3. Paste your Client ID
    4. Click Save
    
    See: `spotify_auth.rs:112`
  </Step>
  
  <Step title="Authorize">
    Follow the OAuth flow as described above
  </Step>
</Steps>

<Note>
  MiniFy uses PKCE (Proof Key for Code Exchange) for secure authentication without requiring a client secret.
  
  See: `spotify_auth.rs:158-174`
</Note>

### Spotify Token Management

Spotify access tokens expire after 1 hour. MiniFy handles refresh automatically:

- Tokens are stored securely in your system keyring
- Automatic refresh runs every 5 minutes
- Manual refresh available if needed

See: `spotify_auth.rs:597`, `spotify_auth.rs:643`

### Spotify Credential Storage

<CodeGroup>
```text macOS
Keychain Access
Service: minify
Accounts:
  - access_token
  - refresh_token  
  - token_expiry
  - spotify_client_id (if custom)
```

```text Windows
Credential Manager
Targets:
  - minify\access_token
  - minify\refresh_token
  - minify\token_expiry
  - minify\spotify_client_id (if custom)
```

```text Linux  
Secret Service
Service: minify
Users:
  - access_token
  - refresh_token
  - token_expiry
  - spotify_client_id (if custom)
```
</CodeGroup>

See: `spotify_auth.rs:16-21`

## YouTube Music Setup

### Using Official Builds

YouTube Music authentication may be pre-configured in official builds:

<Steps>
  <Step title="Open Settings">
    Navigate to Settings > Music Provider > YouTube Music
  </Step>
  
  <Step title="Start OAuth">
    Click "Connect YouTube Music"
    
    See: `youtube_auth.rs:354`
  </Step>
  
  <Step title="Authorize in Browser">
    Your browser opens to Google's authorization page
    
    MiniFy requests these permissions:
    - `https://www.googleapis.com/auth/youtube`: Full YouTube access
    - `https://www.googleapis.com/auth/youtube.readonly`: Read-only access
    
    See: `youtube_auth.rs:450`
  </Step>
  
  <Step title="Complete Authorization">
    1. Select your Google account
    2. Review permissions
    3. Click "Allow"
    
    The browser redirects to a success page.
  </Step>
</Steps>

### Using Custom Credentials

<Steps>
  <Step title="Create Google Cloud Project">
    1. Go to https://console.cloud.google.com/
    2. Create a new project
    3. Enable YouTube Data API v3
  </Step>
  
  <Step title="Create OAuth Credentials">
    1. Go to APIs & Services > Credentials
    2. Click "Create Credentials" > "OAuth client ID"
    3. Application type: Desktop app
    4. Add authorized redirect URI: `http://127.0.0.1:3001/callback`
    5. Save and download credentials
  </Step>
  
  <Step title="Configure MiniFy">
    1. Open Settings > Music Provider > YouTube Music
    2. Click "Custom Credentials"
    3. Enter your Client ID and Client Secret
    4. Click Save
    
    See: `youtube_auth.rs:146`
  </Step>
  
  <Step title="Authorize">
    Follow the OAuth flow as described above
  </Step>
</Steps>

<Warning>
  Unlike Spotify, YouTube Music OAuth requires both a Client ID and Client Secret. Keep your Client Secret secure.
</Warning>

### YouTube Token Management

YouTube access tokens expire after 1 hour:

- Tokens stored securely in system keyring
- Automatic refresh every 5 minutes
- Manual refresh available

See: `youtube_auth.rs:555`, `youtube_auth.rs:607`

### YouTube Credential Storage

<CodeGroup>
```text macOS
Keychain Access
Service: minify
Accounts:
  - youtube_access_token
  - youtube_refresh_token
  - youtube_token_expiry
  - youtube_client_id (if custom)
  - youtube_client_secret (if custom)
```

```text Windows
Credential Manager
Targets:
  - minify\youtube_access_token
  - minify\youtube_refresh_token
  - minify\youtube_token_expiry
  - minify\youtube_client_id (if custom)
  - minify\youtube_client_secret (if custom)
```

```text Linux
Secret Service
Service: minify
Users:
  - youtube_access_token
  - youtube_refresh_token
  - youtube_token_expiry
  - youtube_client_id (if custom)
  - youtube_client_secret (if custom)
```
</CodeGroup>

See: `youtube_auth.rs:14-19`

## Switching Providers

You can configure both providers and switch between them:

<Steps>
  <Step title="Configure Both">
    Authenticate with both Spotify and YouTube Music
  </Step>
  
  <Step title="Select Active Provider">
    Open Settings > Music Provider > Active Provider
    
    Choose which service to use for playback
    
    See: `spotify_auth.rs:177`
  </Step>
  
  <Step title="Switch Anytime">
    Change the active provider at any time without re-authenticating
  </Step>
</Steps>

The active provider is stored in settings:

```json settings.json
{
  "active_music_provider": "spotify"
}
```

See: `settings.rs:61`

## OAuth Flow Details

### Spotify OAuth (PKCE)

<Steps>
  <Step title="Generate Code Verifier">
    MiniFy generates a random 64-character code verifier
    
    See: `spotify_auth.rs:158`
  </Step>
  
  <Step title="Create Code Challenge">
    SHA256 hash of the verifier, base64url encoded
    
    See: `spotify_auth.rs:169`
  </Step>
  
  <Step title="Authorization Request">
    Browser opens with authorization URL including challenge
    
    See: `spotify_auth.rs:484`
  </Step>
  
  <Step title="Local Server">
    MiniFy starts a local server on port 3000 to receive the callback
    
    See: `spotify_auth.rs:451`
  </Step>
  
  <Step title="Token Exchange">
    Exchange authorization code for access/refresh tokens using the verifier
    
    See: `spotify_auth.rs:326`
  </Step>
  
  <Step title="Store Tokens">
    Save tokens securely in system keyring
    
    See: `spotify_auth.rs:216`
  </Step>
</Steps>

### YouTube OAuth

<Steps>
  <Step title="State Parameter">
    MiniFy generates a random state nonce for CSRF protection
    
    See: `youtube_auth.rs:375`
  </Step>
  
  <Step title="Authorization Request">
    Browser opens Google's OAuth page with offline access
    
    See: `youtube_auth.rs:451`
  </Step>
  
  <Step title="Local Server">
    MiniFy starts a local server on port 3001 for the callback
    
    See: `youtube_auth.rs:418`
  </Step>
  
  <Step title="Token Exchange">
    Exchange authorization code for tokens using client secret
    
    See: `youtube_auth.rs:295`
  </Step>
  
  <Step title="Store Tokens">
    Save tokens securely in system keyring
    
    See: `youtube_auth.rs:202`
  </Step>
</Steps>

## Removing Providers

### Clear Spotify

<Steps>
  <Step title="Open Settings">
    Navigate to Settings > Music Provider > Spotify
  </Step>
  
  <Step title="Disconnect">
    Click "Disconnect Spotify"
  </Step>
  
  <Step title="Confirm">
    Confirm to remove all stored credentials
    
    See: `spotify_auth.rs:301`
  </Step>
</Steps>

### Clear YouTube Music

<Steps>
  <Step title="Open Settings">
    Navigate to Settings > Music Provider > YouTube Music
  </Step>
  
  <Step title="Disconnect">
    Click "Disconnect YouTube Music"
  </Step>
  
  <Step title="Confirm">
    Confirm to remove all stored credentials
    
    See: `youtube_auth.rs:270`
  </Step>
</Steps>

## Troubleshooting

### OAuth Timeout

**Symptoms**: "OAuth timeout - please try again" message

**Solutions**:
1. Complete the authorization within 5 minutes
2. Ensure the callback URL is correct
3. Check that no firewall is blocking local ports 3000/3001
4. Close old browser tabs and retry

See: `spotify_auth.rs:470`, `youtube_auth.rs:437`

### Invalid Client ID

**Symptoms**: "Invalid credentials - check your Client ID" error

**Solutions**:
1. Verify Client ID is copied correctly from your app dashboard
2. Ensure the redirect URI in your app matches exactly:
   - Spotify: `http://127.0.0.1:3000/callback`
   - YouTube: `http://127.0.0.1:3001/callback`
3. For YouTube, verify Client Secret is also correct
4. Check that your app is not in restricted mode

See: `spotify_auth.rs:540`, `youtube_auth.rs:499`

### Session Expired

**Symptoms**: "Session expired - please close old browser tabs and try again"

**Solutions**:
1. Close all browser tabs with Spotify/Google login
2. Restart the OAuth flow in MiniFy
3. Clear browser cookies for Spotify/Google if issues persist

See: `spotify_auth.rs:521`, `youtube_auth.rs:487`

### Port Already in Use

**Symptoms**: "bind_failed" error when starting OAuth

**Solutions**:
1. Close any other applications using port 3000 (Spotify) or 3001 (YouTube)
2. Wait a few seconds and retry
3. Restart MiniFy to release the port

See: `spotify_auth.rs:454`, `youtube_auth.rs:421`

### Token Refresh Failed

**Symptoms**: Playback stops working after initial setup

**Solutions**:
1. Check your internet connection
2. Verify the refresh token hasn't been revoked
3. Re-authenticate with the provider
4. Check provider status pages for outages

See: `spotify_auth.rs:597`, `youtube_auth.rs:555`

### No Active Device (Spotify)

**Symptoms**: Cannot control playback

**Solutions**:
1. Open Spotify on any device (phone, desktop, web)
2. Start playing something to activate the device
3. Select the device in MiniFy
4. Ensure Spotify Premium is active

### Multiple Sessions

**Issue**: Trying to start OAuth while already in progress

**Solution**: MiniFy automatically cancels the previous session. If stuck, restart MiniFy.

See: `spotify_auth.rs:390`, `youtube_auth.rs:355`

## Best Practices

### Security

- Never share your OAuth credentials
- Use official builds when possible (pre-configured)
- Revoke access in provider dashboards if compromised
- Keep custom Client IDs/Secrets private

### Performance

- Tokens are cached in memory for faster access
- Automatic refresh prevents expired token errors
- Keep MiniFy running for best experience

### Privacy

- MiniFy only requests necessary permissions
- Credentials stored locally in secure keyring
- No data sent to third parties
- You can revoke access anytime in your provider's account settings

<Note>
  OAuth servers have rate limits. If authentication fails repeatedly, wait a few minutes before retrying.
</Note>